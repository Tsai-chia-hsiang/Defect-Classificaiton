from dataset/train_valid_test/baseline.json reading all data
class-label map: {'Type0': 0, 'Type1': 1, 'Type2': 2, 'Type3': 3}
settings :
lr: 0.001, epochs : 50, batchsize : 68
{'Type0': 0, 'Type1': 1, 'Type2': 2, 'Type3': 3}
resnet50
model will be saved at ckpt/test50/baseline_focal/resnet50.pt
train data : tensor([1026.,   32.,  302.,  416.])
valid data : tensor([115.,   4.,  34.,  47.])
lossw for Focal Loss : train : tensor([ 1.7310, 55.5000,  5.8808,  4.2692], device='cuda:0'), valid : tensor([ 1.7391, 50.0000,  5.8824,  4.2553], device='cuda:0')
Using 4 GPUs!
train 0 time: 44.579 secs | loss : 2.394 | acc: 0.561
f1 : 0.471, best f1 : 0.000, save model : train
stop count :0
recall: 0.545
0 : 606/1026=0.591
1 : 17/32=0.531
2 : 177/302=0.586
3 : 197/416=0.474
valid 0 time: 1.371 secs | loss : 3.112 | acc: 0.020
f1 : 0.010, best f1 : 0.010, save model : True
stop count :0
recall: 0.250
0 : 0/115=0.000
1 : 4/4=1.000
2 : 0/34=0.000
3 : 0/47=0.000
====================================================================================================
train 1 time: 40.343 secs | loss : 1.341 | acc: 0.834
f1 : 0.677, best f1 : 0.010, save model : train
stop count :0
recall: 0.751
0 : 955/1026=0.931
1 : 22/32=0.688
2 : 194/302=0.642
3 : 310/416=0.745
valid 1 time: 1.296 secs | loss : 2.325 | acc: 0.380
f1 : 0.371, best f1 : 0.371, save model : True
stop count :0
recall: 0.449
0 : 28/115=0.243
1 : 2/4=0.500
2 : 9/34=0.265
3 : 37/47=0.787
====================================================================================================
train 2 time: 40.352 secs | loss : 1.467 | acc: 0.837
f1 : 0.680, best f1 : 0.371, save model : train
stop count :0
recall: 0.764
0 : 971/1026=0.946
1 : 24/32=0.750
2 : 197/302=0.652
3 : 295/416=0.709
valid 2 time: 1.323 secs | loss : 1.471 | acc: 0.910
f1 : 0.815, best f1 : 0.815, save model : True
stop count :0
recall: 0.899
0 : 114/115=0.991
1 : 4/4=1.000
2 : 30/34=0.882
3 : 34/47=0.723
====================================================================================================
train 3 time: 41.149 secs | loss : 0.737 | acc: 0.897
f1 : 0.789, best f1 : 0.815, save model : train
stop count :0
recall: 0.866
0 : 985/1026=0.960
1 : 29/32=0.906
2 : 228/302=0.755
3 : 351/416=0.844
valid 3 time: 1.327 secs | loss : 0.629 | acc: 0.930
f1 : 0.866, best f1 : 0.866, save model : True
stop count :0
recall: 0.875
0 : 111/115=0.965
1 : 3/4=0.750
2 : 31/34=0.912
3 : 41/47=0.872
====================================================================================================
train 4 time: 40.743 secs | loss : 0.530 | acc: 0.911
f1 : 0.828, best f1 : 0.866, save model : train
stop count :0
recall: 0.885
0 : 998/1026=0.973
1 : 30/32=0.938
2 : 234/302=0.775
3 : 356/416=0.856
valid 4 time: 1.289 secs | loss : 0.557 | acc: 0.935
f1 : 0.853, best f1 : 0.866, save model : False
stop count :1
recall: 0.876
0 : 113/115=0.983
1 : 3/4=0.750
2 : 32/34=0.941
3 : 39/47=0.830
====================================================================================================
train 5 time: 41.486 secs | loss : 1.064 | acc: 0.865
f1 : 0.754, best f1 : 0.866, save model : train
stop count :1
recall: 0.816
0 : 990/1026=0.965
1 : 27/32=0.844
2 : 228/302=0.755
3 : 292/416=0.702
valid 5 time: 1.369 secs | loss : 1.155 | acc: 0.840
f1 : 0.685, best f1 : 0.866, save model : False
stop count :2
recall: 0.828
0 : 113/115=0.983
1 : 4/4=1.000
2 : 30/34=0.882
3 : 21/47=0.447
====================================================================================================
train 6 time: 41.107 secs | loss : 0.707 | acc: 0.900
f1 : 0.786, best f1 : 0.866, save model : train
stop count :2
recall: 0.862
0 : 989/1026=0.964
1 : 28/32=0.875
2 : 233/302=0.772
3 : 349/416=0.839
valid 6 time: 1.323 secs | loss : 0.897 | acc: 0.940
f1 : 0.875, best f1 : 0.875, save model : True
stop count :0
recall: 0.880
0 : 114/115=0.991
1 : 3/4=0.750
2 : 33/34=0.971
3 : 38/47=0.809
====================================================================================================
train 7 time: 41.079 secs | loss : 1.065 | acc: 0.882
f1 : 0.761, best f1 : 0.875, save model : train
stop count :0
recall: 0.830
0 : 987/1026=0.962
1 : 26/32=0.812
2 : 238/302=0.788
3 : 315/416=0.757
valid 7 time: 1.348 secs | loss : 12.294 | acc: 0.530
f1 : 0.304, best f1 : 0.875, save model : False
stop count :1
recall: 0.492
0 : 98/115=0.852
1 : 4/4=1.000
2 : 4/34=0.118
3 : 0/47=0.000
====================================================================================================
train 8 time: 41.403 secs | loss : 0.862 | acc: 0.867
f1 : 0.766, best f1 : 0.875, save model : train
stop count :1
recall: 0.840
0 : 965/1026=0.941
1 : 29/32=0.906
2 : 220/302=0.728
3 : 326/416=0.784
valid 8 time: 1.401 secs | loss : 0.786 | acc: 0.910
f1 : 0.840, best f1 : 0.875, save model : False
stop count :2
recall: 0.884
0 : 115/115=1.000
1 : 4/4=1.000
2 : 24/34=0.706
3 : 39/47=0.830
====================================================================================================
train 9 time: 41.102 secs | loss : 0.813 | acc: 0.902
f1 : 0.808, best f1 : 0.875, save model : train
stop count :2
recall: 0.874
0 : 986/1026=0.961
1 : 29/32=0.906
2 : 239/302=0.791
3 : 348/416=0.837
valid 9 time: 1.275 secs | loss : 1.112 | acc: 0.770
f1 : 0.641, best f1 : 0.875, save model : False
stop count :3
recall: 0.720
0 : 108/115=0.939
1 : 3/4=0.750
2 : 34/34=1.000
3 : 9/47=0.191
====================================================================================================
train 10 time: 41.213 secs | loss : 0.579 | acc: 0.913
f1 : 0.823, best f1 : 0.875, save model : train
stop count :3
recall: 0.882
0 : 997/1026=0.972
1 : 29/32=0.906
2 : 238/302=0.788
3 : 358/416=0.861
valid 10 time: 1.296 secs | loss : 1.802 | acc: 0.770
f1 : 0.599, best f1 : 0.875, save model : False
stop count :4
recall: 0.747
0 : 113/115=0.983
1 : 4/4=1.000
2 : 27/34=0.794
3 : 10/47=0.213
====================================================================================================
train 11 time: 41.188 secs | loss : 0.380 | acc: 0.928
f1 : 0.876, best f1 : 0.875, save model : train
stop count :4
recall: 0.924
0 : 1000/1026=0.975
1 : 32/32=1.000
2 : 264/302=0.874
3 : 353/416=0.849
valid 11 time: 1.391 secs | loss : 0.778 | acc: 0.880
f1 : 0.764, best f1 : 0.875, save model : False
stop count :5
recall: 0.851
0 : 110/115=0.957
1 : 4/4=1.000
2 : 16/34=0.471
3 : 46/47=0.979
====================================================================================================
train 12 time: 41.409 secs | loss : 1.001 | acc: 0.919
f1 : 0.874, best f1 : 0.875, save model : train
stop count :5
recall: 0.900
0 : 993/1026=0.968
1 : 30/32=0.938
2 : 250/302=0.828
3 : 360/416=0.865
valid 12 time: 1.661 secs | loss : 2.441 | acc: 0.775
f1 : 0.564, best f1 : 0.875, save model : False
stop count :6
recall: 0.771
0 : 111/115=0.965
1 : 4/4=1.000
2 : 33/34=0.971
3 : 7/47=0.149
====================================================================================================
train 13 time: 41.148 secs | loss : 0.825 | acc: 0.889
f1 : 0.762, best f1 : 0.875, save model : train
stop count :6
recall: 0.868
0 : 982/1026=0.957
1 : 30/32=0.938
2 : 237/302=0.785
3 : 329/416=0.791
valid 13 time: 1.382 secs | loss : 0.647 | acc: 0.945
f1 : 0.897, best f1 : 0.897, save model : True
stop count :0
recall: 0.932
0 : 114/115=0.991
1 : 4/4=1.000
2 : 28/34=0.824
3 : 43/47=0.915
====================================================================================================
train 14 time: 40.981 secs | loss : 0.402 | acc: 0.937
f1 : 0.881, best f1 : 0.897, save model : train
stop count :0
recall: 0.932
0 : 1002/1026=0.977
1 : 32/32=1.000
2 : 260/302=0.861
3 : 370/416=0.889
valid 14 time: 1.317 secs | loss : 0.839 | acc: 0.935
f1 : 0.798, best f1 : 0.897, save model : False
stop count :1
recall: 0.802
0 : 115/115=1.000
1 : 2/4=0.500
2 : 27/34=0.794
3 : 43/47=0.915
====================================================================================================
train 15 time: 40.664 secs | loss : 0.380 | acc: 0.931
f1 : 0.885, best f1 : 0.897, save model : train
stop count :1
recall: 0.919
0 : 1004/1026=0.979
1 : 31/32=0.969
2 : 267/302=0.884
3 : 352/416=0.846
valid 15 time: 1.328 secs | loss : 1.912 | acc: 0.890
f1 : 0.755, best f1 : 0.897, save model : False
stop count :2
recall: 0.884
0 : 112/115=0.974
1 : 4/4=1.000
2 : 30/34=0.882
3 : 32/47=0.681
====================================================================================================
train 16 time: 41.114 secs | loss : 0.445 | acc: 0.938
f1 : 0.875, best f1 : 0.897, save model : train
stop count :2
recall: 0.926
0 : 1004/1026=0.979
1 : 31/32=0.969
2 : 268/302=0.887
3 : 362/416=0.870
valid 16 time: 1.352 secs | loss : 1.237 | acc: 0.865
f1 : 0.762, best f1 : 0.897, save model : False
stop count :3
recall: 0.793
0 : 98/115=0.852
1 : 2/4=0.500
2 : 33/34=0.971
3 : 40/47=0.851
====================================================================================================
train 17 time: 40.877 secs | loss : 0.529 | acc: 0.933
f1 : 0.875, best f1 : 0.897, save model : train
stop count :3
recall: 0.903
0 : 1007/1026=0.981
1 : 29/32=0.906
2 : 253/302=0.838
3 : 368/416=0.885
valid 17 time: 1.406 secs | loss : 3.671 | acc: 0.835
f1 : 0.675, best f1 : 0.897, save model : False
stop count :4
recall: 0.826
0 : 112/115=0.974
1 : 4/4=1.000
2 : 30/34=0.882
3 : 21/47=0.447
====================================================================================================
train 18 time: 41.078 secs | loss : 0.454 | acc: 0.939
f1 : 0.866, best f1 : 0.897, save model : train
stop count :4
recall: 0.940
0 : 993/1026=0.968
1 : 32/32=1.000
2 : 270/302=0.894
3 : 373/416=0.897
valid 18 time: 1.390 secs | loss : 0.695 | acc: 0.940
f1 : 0.832, best f1 : 0.897, save model : False
stop count :5
recall: 0.820
0 : 115/115=1.000
1 : 2/4=0.500
2 : 33/34=0.971
3 : 38/47=0.809
====================================================================================================
train 19 time: 41.361 secs | loss : 0.237 | acc: 0.954
f1 : 0.930, best f1 : 0.897, save model : train
stop count :5
recall: 0.945
0 : 1010/1026=0.984
1 : 31/32=0.969
2 : 281/302=0.930
3 : 373/416=0.897
valid 19 time: 1.389 secs | loss : 0.805 | acc: 0.955
f1 : 0.854, best f1 : 0.897, save model : False
stop count :6
recall: 0.901
0 : 111/115=0.965
1 : 3/4=0.750
2 : 31/34=0.912
3 : 46/47=0.979
====================================================================================================
train 20 time: 41.588 secs | loss : 0.217 | acc: 0.958
f1 : 0.922, best f1 : 0.897, save model : train
stop count :6
recall: 0.955
0 : 1012/1026=0.986
1 : 32/32=1.000
2 : 279/302=0.924
3 : 378/416=0.909
valid 20 time: 1.402 secs | loss : 0.284 | acc: 0.950
f1 : 0.870, best f1 : 0.897, save model : False
stop count :7
recall: 0.949
0 : 113/115=0.983
1 : 4/4=1.000
2 : 32/34=0.941
3 : 41/47=0.872
====================================================================================================
train 21 time: 41.473 secs | loss : 0.209 | acc: 0.961
f1 : 0.932, best f1 : 0.897, save model : train
stop count :7
recall: 0.956
0 : 1017/1026=0.991
1 : 32/32=1.000
2 : 278/302=0.921
3 : 380/416=0.913
valid 21 time: 1.390 secs | loss : 0.932 | acc: 0.885
f1 : 0.792, best f1 : 0.897, save model : False
stop count :8
recall: 0.862
0 : 100/115=0.870
1 : 3/4=0.750
2 : 31/34=0.912
3 : 43/47=0.915
====================================================================================================
train 22 time: 41.188 secs | loss : 0.687 | acc: 0.916
f1 : 0.821, best f1 : 0.897, save model : train
stop count :8
recall: 0.884
0 : 991/1026=0.966
1 : 28/32=0.875
2 : 257/302=0.851
3 : 351/416=0.844
valid 22 time: 1.323 secs | loss : 4.386 | acc: 0.730
f1 : 0.487, best f1 : 0.897, save model : False
stop count :9
recall: 0.715
0 : 111/115=0.965
1 : 4/4=1.000
2 : 29/34=0.853
3 : 2/47=0.043
====================================================================================================
train 23 time: 41.296 secs | loss : 0.453 | acc: 0.918
f1 : 0.848, best f1 : 0.897, save model : train
stop count :9
recall: 0.910
0 : 993/1026=0.968
1 : 32/32=1.000
2 : 241/302=0.798
3 : 364/416=0.875
valid 23 time: 1.335 secs | loss : 1.154 | acc: 0.805
f1 : 0.633, best f1 : 0.897, save model : False
stop count :10
recall: 0.687
0 : 111/115=0.965
1 : 2/4=0.500
2 : 32/34=0.941
3 : 16/47=0.340
====================================================================================================
train 24 time: 41.597 secs | loss : 0.310 | acc: 0.939
f1 : 0.903, best f1 : 0.897, save model : train
stop count :10
recall: 0.929
0 : 1002/1026=0.977
1 : 31/32=0.969
2 : 271/302=0.897
3 : 363/416=0.873
valid 24 time: 1.305 secs | loss : 0.872 | acc: 0.915
f1 : 0.804, best f1 : 0.897, save model : False
stop count :11
recall: 0.847
0 : 114/115=0.991
1 : 3/4=0.750
2 : 30/34=0.882
3 : 36/47=0.766
====================================================================================================
train 25 time: 41.153 secs | loss : 0.215 | acc: 0.957
f1 : 0.917, best f1 : 0.897, save model : train
stop count :11
recall: 0.953
0 : 1013/1026=0.987
1 : 32/32=1.000
2 : 276/302=0.914
3 : 379/416=0.911
valid 25 time: 1.360 secs | loss : 0.317 | acc: 0.955
f1 : 0.906, best f1 : 0.906, save model : True
stop count :0
recall: 0.951
0 : 114/115=0.991
1 : 4/4=1.000
2 : 32/34=0.941
3 : 41/47=0.872
====================================================================================================
train 26 time: 41.058 secs | loss : 0.146 | acc: 0.962
f1 : 0.949, best f1 : 0.906, save model : train
stop count :0
recall: 0.957
0 : 1015/1026=0.989
1 : 32/32=1.000
2 : 277/302=0.917
3 : 384/416=0.923
valid 26 time: 1.365 secs | loss : 0.376 | acc: 0.975
f1 : 0.912, best f1 : 0.912, save model : True
stop count :0
recall: 0.910
0 : 115/115=1.000
1 : 3/4=0.750
2 : 31/34=0.912
3 : 46/47=0.979
====================================================================================================
train 27 time: 41.111 secs | loss : 0.107 | acc: 0.977
f1 : 0.971, best f1 : 0.912, save model : train
stop count :0
recall: 0.974
0 : 1016/1026=0.990
1 : 32/32=1.000
2 : 281/302=0.930
3 : 406/416=0.976
valid 27 time: 1.394 secs | loss : 0.502 | acc: 0.960
f1 : 0.894, best f1 : 0.912, save model : False
stop count :1
recall: 0.896
0 : 115/115=1.000
1 : 3/4=0.750
2 : 32/34=0.941
3 : 42/47=0.894
====================================================================================================
train 28 time: 41.185 secs | loss : 0.069 | acc: 0.984
f1 : 0.975, best f1 : 0.912, save model : train
stop count :1
recall: 0.983
0 : 1019/1026=0.993
1 : 32/32=1.000
2 : 295/302=0.977
3 : 401/416=0.964
valid 28 time: 1.392 secs | loss : 0.348 | acc: 0.980
f1 : 0.931, best f1 : 0.931, save model : True
stop count :0
recall: 0.975
0 : 115/115=1.000
1 : 4/4=1.000
2 : 32/34=0.941
3 : 45/47=0.957
====================================================================================================
train 29 time: 41.362 secs | loss : 0.056 | acc: 0.990
f1 : 0.986, best f1 : 0.931, save model : train
stop count :0
recall: 0.991
0 : 1019/1026=0.993
1 : 32/32=1.000
2 : 297/302=0.983
3 : 411/416=0.988
valid 29 time: 1.283 secs | loss : 0.579 | acc: 0.980
f1 : 0.918, best f1 : 0.931, save model : False
stop count :1
recall: 0.917
0 : 115/115=1.000
1 : 3/4=0.750
2 : 32/34=0.941
3 : 46/47=0.979
====================================================================================================
train 30 time: 41.175 secs | loss : 0.053 | acc: 0.985
f1 : 0.983, best f1 : 0.931, save model : train
stop count :1
recall: 0.984
0 : 1020/1026=0.994
1 : 32/32=1.000
2 : 293/302=0.970
3 : 405/416=0.974
valid 30 time: 1.400 secs | loss : 0.927 | acc: 0.970
f1 : 0.905, best f1 : 0.931, save model : False
stop count :2
recall: 0.901
0 : 115/115=1.000
1 : 3/4=0.750
2 : 29/34=0.853
3 : 47/47=1.000
====================================================================================================
train 31 time: 41.002 secs | loss : 0.073 | acc: 0.993
f1 : 0.992, best f1 : 0.931, save model : train
stop count :2
recall: 0.992
0 : 1022/1026=0.996
1 : 32/32=1.000
2 : 296/302=0.980
3 : 413/416=0.993
valid 31 time: 1.339 secs | loss : 0.558 | acc: 0.960
f1 : 0.876, best f1 : 0.931, save model : False
stop count :3
recall: 0.898
0 : 115/115=1.000
1 : 3/4=0.750
2 : 33/34=0.971
3 : 41/47=0.872
====================================================================================================
train 32 time: 41.531 secs | loss : 0.159 | acc: 0.963
f1 : 0.954, best f1 : 0.931, save model : train
stop count :3
recall: 0.958
0 : 1019/1026=0.993
1 : 32/32=1.000
2 : 279/302=0.924
3 : 381/416=0.916
valid 32 time: 1.352 secs | loss : 0.801 | acc: 0.975
f1 : 0.917, best f1 : 0.931, save model : False
stop count :4
recall: 0.915
0 : 114/115=0.991
1 : 3/4=0.750
2 : 32/34=0.941
3 : 46/47=0.979
====================================================================================================
train 33 time: 40.945 secs | loss : 0.077 | acc: 0.985
f1 : 0.980, best f1 : 0.931, save model : train
stop count :4
recall: 0.984
0 : 1018/1026=0.992
1 : 32/32=1.000
2 : 289/302=0.957
3 : 411/416=0.988
valid 33 time: 1.309 secs | loss : 0.445 | acc: 0.965
f1 : 0.902, best f1 : 0.931, save model : False
stop count :5
recall: 0.905
0 : 114/115=0.991
1 : 3/4=0.750
2 : 32/34=0.941
3 : 44/47=0.936
====================================================================================================
train 34 time: 40.918 secs | loss : 0.067 | acc: 0.992
f1 : 0.990, best f1 : 0.931, save model : train
stop count :5
recall: 0.990
0 : 1024/1026=0.998
1 : 32/32=1.000
2 : 293/302=0.970
3 : 412/416=0.990
valid 34 time: 1.414 secs | loss : 0.501 | acc: 0.975
f1 : 0.912, best f1 : 0.931, save model : False
stop count :6
recall: 0.912
0 : 115/115=1.000
1 : 3/4=0.750
2 : 32/34=0.941
3 : 45/47=0.957
====================================================================================================
train 35 time: 41.024 secs | loss : 0.113 | acc: 0.975
f1 : 0.967, best f1 : 0.931, save model : train
stop count :6
recall: 0.972
0 : 1019/1026=0.993
1 : 32/32=1.000
2 : 288/302=0.954
3 : 392/416=0.942
valid 35 time: 1.250 secs | loss : 0.679 | acc: 0.875
f1 : 0.763, best f1 : 0.931, save model : False
stop count :7
recall: 0.866
0 : 114/115=0.991
1 : 4/4=1.000
2 : 32/34=0.941
3 : 25/47=0.532
====================================================================================================
train 36 time: 41.523 secs | loss : 0.072 | acc: 0.983
f1 : 0.978, best f1 : 0.931, save model : train
stop count :7
recall: 0.982
0 : 1019/1026=0.993
1 : 32/32=1.000
2 : 293/302=0.970
3 : 401/416=0.964
valid 36 time: 1.367 secs | loss : 0.668 | acc: 0.980
f1 : 0.920, best f1 : 0.931, save model : False
stop count :8
recall: 0.915
0 : 115/115=1.000
1 : 3/4=0.750
2 : 31/34=0.912
3 : 47/47=1.000
====================================================================================================
train 37 time: 41.346 secs | loss : 0.060 | acc: 0.994
f1 : 0.994, best f1 : 0.931, save model : train
stop count :8
recall: 0.995
0 : 1023/1026=0.997
1 : 32/32=1.000
2 : 300/302=0.993
3 : 411/416=0.988
valid 37 time: 1.304 secs | loss : 0.877 | acc: 0.965
f1 : 0.902, best f1 : 0.931, save model : False
stop count :9
recall: 0.901
0 : 114/115=0.991
1 : 3/4=0.750
2 : 30/34=0.882
3 : 46/47=0.979
====================================================================================================
train 38 time: 41.078 secs | loss : 0.109 | acc: 0.985
f1 : 0.960, best f1 : 0.931, save model : train
stop count :9
recall: 0.977
0 : 1019/1026=0.993
1 : 31/32=0.969
2 : 291/302=0.964
3 : 408/416=0.981
valid 38 time: 1.308 secs | loss : 12.273 | acc: 0.740
f1 : 0.493, best f1 : 0.931, save model : False
stop count :10
recall: 0.548
0 : 115/115=1.000
1 : 1/4=0.250
2 : 32/34=0.941
3 : 0/47=0.000
====================================================================================================
train 39 time: 40.866 secs | loss : 0.162 | acc: 0.972
f1 : 0.938, best f1 : 0.931, save model : train
stop count :10
recall: 0.973
0 : 1009/1026=0.983
1 : 32/32=1.000
2 : 288/302=0.954
3 : 398/416=0.957
valid 39 time: 1.310 secs | loss : 2.223 | acc: 0.965
f1 : 0.853, best f1 : 0.931, save model : False
stop count :11
recall: 0.851
0 : 113/115=0.983
1 : 2/4=0.500
2 : 32/34=0.941
3 : 46/47=0.979
====================================================================================================
train 40 time: 41.298 secs | loss : 0.122 | acc: 0.978
f1 : 0.971, best f1 : 0.931, save model : train
stop count :11
recall: 0.975
0 : 1019/1026=0.993
1 : 32/32=1.000
2 : 285/302=0.944
3 : 401/416=0.964
valid 40 time: 1.360 secs | loss : 0.542 | acc: 0.925
f1 : 0.833, best f1 : 0.931, save model : False
stop count :12
recall: 0.863
0 : 115/115=1.000
1 : 3/4=0.750
2 : 34/34=1.000
3 : 33/47=0.702
====================================================================================================
train 41 time: 41.055 secs | loss : 0.101 | acc: 0.980
f1 : 0.964, best f1 : 0.931, save model : train
stop count :12
recall: 0.979
0 : 1018/1026=0.992
1 : 32/32=1.000
2 : 293/302=0.970
3 : 397/416=0.954
valid 41 time: 1.393 secs | loss : 0.699 | acc: 0.975
f1 : 0.939, best f1 : 0.939, save model : True
stop count :0
recall: 0.915
0 : 114/115=0.991
1 : 3/4=0.750
2 : 32/34=0.941
3 : 46/47=0.979
====================================================================================================
train 42 time: 41.321 secs | loss : 0.066 | acc: 0.986
f1 : 0.985, best f1 : 0.939, save model : train
stop count :0
recall: 0.987
0 : 1018/1026=0.992
1 : 32/32=1.000
2 : 295/302=0.977
3 : 407/416=0.978
valid 42 time: 1.506 secs | loss : 0.365 | acc: 0.950
f1 : 0.870, best f1 : 0.939, save model : False
stop count :1
recall: 0.946
0 : 114/115=0.991
1 : 4/4=1.000
2 : 32/34=0.941
3 : 40/47=0.851
====================================================================================================
train 43 time: 41.082 secs | loss : 0.040 | acc: 0.995
f1 : 0.991, best f1 : 0.939, save model : train
stop count :1
recall: 0.995
0 : 1024/1026=0.998
1 : 32/32=1.000
2 : 299/302=0.990
3 : 412/416=0.990
valid 43 time: 1.335 secs | loss : 0.301 | acc: 0.975
f1 : 0.896, best f1 : 0.939, save model : False
stop count :2
recall: 0.915
0 : 114/115=0.991
1 : 3/4=0.750
2 : 32/34=0.941
3 : 46/47=0.979
====================================================================================================
train 44 time: 41.433 secs | loss : 0.057 | acc: 0.992
f1 : 0.987, best f1 : 0.939, save model : train
stop count :2
recall: 0.992
0 : 1021/1026=0.995
1 : 32/32=1.000
2 : 298/302=0.987
3 : 410/416=0.986
valid 44 time: 1.400 secs | loss : 0.307 | acc: 0.965
f1 : 0.887, best f1 : 0.939, save model : False
stop count :3
recall: 0.905
0 : 114/115=0.991
1 : 3/4=0.750
2 : 32/34=0.941
3 : 44/47=0.936
====================================================================================================
train 45 time: 41.613 secs | loss : 0.092 | acc: 0.986
f1 : 0.986, best f1 : 0.939, save model : train
stop count :3
recall: 0.986
0 : 1019/1026=0.993
1 : 32/32=1.000
2 : 295/302=0.977
3 : 406/416=0.976
valid 45 time: 1.350 secs | loss : 0.340 | acc: 0.950
f1 : 0.924, best f1 : 0.939, save model : False
stop count :4
recall: 0.941
0 : 115/115=1.000
1 : 4/4=1.000
2 : 31/34=0.912
3 : 40/47=0.851
====================================================================================================
train 46 time: 41.338 secs | loss : 0.358 | acc: 0.947
f1 : 0.918, best f1 : 0.939, save model : train
stop count :4
recall: 0.939
0 : 1003/1026=0.978
1 : 31/32=0.969
2 : 277/302=0.917
3 : 371/416=0.892
valid 46 time: 1.371 secs | loss : 2.154 | acc: 0.830
f1 : 0.763, best f1 : 0.939, save model : False
stop count :5
recall: 0.769
0 : 112/115=0.974
1 : 3/4=0.750
2 : 33/34=0.971
3 : 18/47=0.383
====================================================================================================
train 47 time: 41.233 secs | loss : 0.203 | acc: 0.961
f1 : 0.910, best f1 : 0.939, save model : train
stop count :5
recall: 0.946
0 : 1007/1026=0.981
1 : 30/32=0.938
2 : 282/302=0.934
3 : 387/416=0.930
valid 47 time: 1.391 secs | loss : 0.561 | acc: 0.910
f1 : 0.850, best f1 : 0.939, save model : False
stop count :6
recall: 0.901
0 : 114/115=0.991
1 : 4/4=1.000
2 : 31/34=0.912
3 : 33/47=0.702
====================================================================================================
train 48 time: 41.071 secs | loss : 0.108 | acc: 0.979
f1 : 0.954, best f1 : 0.939, save model : train
stop count :6
recall: 0.981
0 : 1009/1026=0.983
1 : 32/32=1.000
2 : 294/302=0.974
3 : 403/416=0.969
valid 48 time: 1.352 secs | loss : 0.866 | acc: 0.955
f1 : 0.860, best f1 : 0.939, save model : False
stop count :7
recall: 0.897
0 : 113/115=0.983
1 : 3/4=0.750
2 : 32/34=0.941
3 : 43/47=0.915
====================================================================================================
train 49 time: 41.742 secs | loss : 0.062 | acc: 0.988
f1 : 0.967, best f1 : 0.939, save model : train
stop count :7
recall: 0.981
0 : 1019/1026=0.993
1 : 31/32=0.969
2 : 299/302=0.990
3 : 405/416=0.974
valid 49 time: 1.400 secs | loss : 0.551 | acc: 0.955
f1 : 0.874, best f1 : 0.939, save model : False
stop count :8
recall: 0.899
0 : 113/115=0.983
1 : 3/4=0.750
2 : 33/34=0.971
3 : 42/47=0.894
====================================================================================================
training using 35.56425288120906 mins.
test 
accuracy : 0.925, f1 : 0.855
recall : 0.841
{0: (273, 286, 0.9545454545454546), 1: (6, 10, 0.6), 2: (78, 84, 0.9285714285714286), 3: (102, 116, 0.8793103448275862)}
