from dataset/train_valid_test/aug.json reading all data
class-label map: {'Type0': 0, 'Type1': 1, 'Type2': 2, 'Type3': 3}
settings :
lr: 0.001, epochs : 50, batchsize : 68
{'Type0': 0, 'Type1': 1, 'Type2': 2, 'Type3': 3}
resnet50
model will be saved at ckpt/test50/aug_focal/resnet50.pt
train data : tensor([1026.,  128.,  906.,  832.])
valid data : tensor([115.,   4.,  34.,  47.])
lossw for Focal Loss : train : tensor([ 2.8187, 22.5938,  3.1921,  3.4760], device='cuda:0'), valid : tensor([ 1.7391, 50.0000,  5.8824,  4.2553], device='cuda:0')
Using 4 GPUs!
train 0 time: 71.101 secs | loss : 1.713 | acc: 0.675
f1 : 0.611, best f1 : 0.000, save model : train
stop count :0
recall: 0.673
0 : 734/1026=0.715
1 : 86/128=0.672
2 : 578/906=0.638
3 : 554/832=0.666
valid 0 time: 1.397 secs | loss : 2.570 | acc: 0.165
f1 : 0.193, best f1 : 0.193, save model : True
stop count :0
recall: 0.404
0 : 0/115=0.000
1 : 3/4=0.750
2 : 28/34=0.824
3 : 2/47=0.043
====================================================================================================
train 1 time: 66.796 secs | loss : 0.808 | acc: 0.840
f1 : 0.788, best f1 : 0.193, save model : train
stop count :0
recall: 0.836
0 : 984/1026=0.959
1 : 108/128=0.844
2 : 680/906=0.751
3 : 657/832=0.790
valid 1 time: 1.368 secs | loss : 3.457 | acc: 0.710
f1 : 0.545, best f1 : 0.545, save model : True
stop count :0
recall: 0.549
0 : 115/115=1.000
1 : 2/4=0.500
2 : 20/34=0.588
3 : 5/47=0.106
====================================================================================================
train 2 time: 67.463 secs | loss : 0.603 | acc: 0.874
f1 : 0.830, best f1 : 0.545, save model : train
stop count :0
recall: 0.874
0 : 1000/1026=0.975
1 : 114/128=0.891
2 : 715/906=0.789
3 : 700/832=0.841
valid 2 time: 1.373 secs | loss : 0.989 | acc: 0.915
f1 : 0.798, best f1 : 0.798, save model : True
stop count :0
recall: 0.905
0 : 114/115=0.991
1 : 4/4=1.000
2 : 30/34=0.882
3 : 35/47=0.745
====================================================================================================
train 3 time: 67.088 secs | loss : 0.656 | acc: 0.861
f1 : 0.822, best f1 : 0.798, save model : train
stop count :0
recall: 0.875
0 : 1005/1026=0.980
1 : 122/128=0.953
2 : 692/906=0.764
3 : 670/832=0.805
valid 3 time: 1.632 secs | loss : 1.728 | acc: 0.840
f1 : 0.691, best f1 : 0.798, save model : False
stop count :1
recall: 0.823
0 : 112/115=0.974
1 : 4/4=1.000
2 : 26/34=0.765
3 : 26/47=0.553
====================================================================================================
train 4 time: 67.276 secs | loss : 0.446 | acc: 0.891
f1 : 0.864, best f1 : 0.798, save model : train
stop count :1
recall: 0.901
0 : 997/1026=0.972
1 : 122/128=0.953
2 : 740/906=0.817
3 : 718/832=0.863
valid 4 time: 1.368 secs | loss : 0.714 | acc: 0.920
f1 : 0.835, best f1 : 0.835, save model : True
stop count :0
recall: 0.920
0 : 110/115=0.957
1 : 4/4=1.000
2 : 29/34=0.853
3 : 41/47=0.872
====================================================================================================
train 5 time: 67.560 secs | loss : 0.311 | acc: 0.919
f1 : 0.900, best f1 : 0.835, save model : train
stop count :0
recall: 0.929
0 : 1008/1026=0.982
1 : 125/128=0.977
2 : 779/906=0.860
3 : 746/832=0.897
valid 5 time: 1.484 secs | loss : 0.955 | acc: 0.935
f1 : 0.876, best f1 : 0.876, save model : True
stop count :0
recall: 0.943
0 : 108/115=0.939
1 : 4/4=1.000
2 : 29/34=0.853
3 : 46/47=0.979
====================================================================================================
train 6 time: 67.548 secs | loss : 0.350 | acc: 0.925
f1 : 0.903, best f1 : 0.876, save model : train
stop count :0
recall: 0.925
0 : 1008/1026=0.982
1 : 120/128=0.938
2 : 806/906=0.890
3 : 742/832=0.892
valid 6 time: 1.375 secs | loss : 1.481 | acc: 0.875
f1 : 0.721, best f1 : 0.876, save model : False
stop count :1
recall: 0.689
0 : 115/115=1.000
1 : 1/4=0.250
2 : 31/34=0.912
3 : 28/47=0.596
====================================================================================================
train 7 time: 67.527 secs | loss : 0.316 | acc: 0.921
f1 : 0.896, best f1 : 0.876, save model : train
stop count :1
recall: 0.927
0 : 1009/1026=0.983
1 : 123/128=0.961
2 : 775/906=0.855
3 : 756/832=0.909
valid 7 time: 1.387 secs | loss : 0.488 | acc: 0.960
f1 : 0.929, best f1 : 0.929, save model : True
stop count :0
recall: 0.958
0 : 113/115=0.983
1 : 4/4=1.000
2 : 31/34=0.912
3 : 44/47=0.936
====================================================================================================
train 8 time: 67.539 secs | loss : 0.311 | acc: 0.929
f1 : 0.910, best f1 : 0.929, save model : train
stop count :0
recall: 0.933
0 : 1012/1026=0.986
1 : 123/128=0.961
2 : 803/906=0.886
3 : 749/832=0.900
valid 8 time: 1.361 secs | loss : 2.488 | acc: 0.735
f1 : 0.491, best f1 : 0.929, save model : False
stop count :1
recall: 0.717
0 : 112/115=0.974
1 : 4/4=1.000
2 : 29/34=0.853
3 : 2/47=0.043
====================================================================================================
train 9 time: 67.567 secs | loss : 0.218 | acc: 0.939
f1 : 0.928, best f1 : 0.929, save model : train
stop count :1
recall: 0.950
0 : 1017/1026=0.991
1 : 128/128=1.000
2 : 808/906=0.892
3 : 763/832=0.917
valid 9 time: 1.374 secs | loss : 0.726 | acc: 0.965
f1 : 0.907, best f1 : 0.929, save model : False
stop count :2
recall: 0.902
0 : 115/115=1.000
1 : 3/4=0.750
2 : 32/34=0.941
3 : 43/47=0.915
====================================================================================================
train 10 time: 67.546 secs | loss : 0.425 | acc: 0.919
f1 : 0.892, best f1 : 0.929, save model : train
stop count :2
recall: 0.923
0 : 1018/1026=0.992
1 : 122/128=0.953
2 : 779/906=0.860
3 : 738/832=0.887
valid 10 time: 1.299 secs | loss : 2.035 | acc: 0.825
f1 : 0.726, best f1 : 0.929, save model : False
stop count :3
recall: 0.753
0 : 115/115=1.000
1 : 3/4=0.750
2 : 32/34=0.941
3 : 15/47=0.319
====================================================================================================
train 11 time: 67.234 secs | loss : 0.483 | acc: 0.906
f1 : 0.862, best f1 : 0.929, save model : train
stop count :3
recall: 0.906
0 : 1009/1026=0.983
1 : 118/128=0.922
2 : 771/906=0.851
3 : 723/832=0.869
valid 11 time: 1.420 secs | loss : 0.761 | acc: 0.945
f1 : 0.862, best f1 : 0.929, save model : False
stop count :4
recall: 0.882
0 : 112/115=0.974
1 : 3/4=0.750
2 : 28/34=0.824
3 : 46/47=0.979
====================================================================================================
train 12 time: 67.572 secs | loss : 0.246 | acc: 0.935
f1 : 0.916, best f1 : 0.929, save model : train
stop count :4
recall: 0.941
0 : 1012/1026=0.986
1 : 125/128=0.977
2 : 816/906=0.901
3 : 750/832=0.901
valid 12 time: 1.342 secs | loss : 0.991 | acc: 0.885
f1 : 0.704, best f1 : 0.929, save model : False
stop count :5
recall: 0.714
0 : 112/115=0.974
1 : 1/4=0.250
2 : 33/34=0.971
3 : 31/47=0.660
====================================================================================================
train 13 time: 67.042 secs | loss : 0.178 | acc: 0.957
f1 : 0.951, best f1 : 0.929, save model : train
stop count :5
recall: 0.961
0 : 1019/1026=0.993
1 : 126/128=0.984
2 : 841/906=0.928
3 : 781/832=0.939
valid 13 time: 1.389 secs | loss : 1.805 | acc: 0.850
f1 : 0.711, best f1 : 0.929, save model : False
stop count :6
recall: 0.843
0 : 111/115=0.965
1 : 4/4=1.000
2 : 29/34=0.853
3 : 26/47=0.553
====================================================================================================
train 14 time: 67.559 secs | loss : 0.230 | acc: 0.943
f1 : 0.934, best f1 : 0.929, save model : train
stop count :6
recall: 0.950
0 : 1011/1026=0.985
1 : 126/128=0.984
2 : 821/906=0.906
3 : 770/832=0.925
valid 14 time: 1.341 secs | loss : 1.305 | acc: 0.930
f1 : 0.889, best f1 : 0.929, save model : False
stop count :7
recall: 0.864
0 : 115/115=1.000
1 : 3/4=0.750
2 : 32/34=0.941
3 : 36/47=0.766
====================================================================================================
train 15 time: 67.568 secs | loss : 0.225 | acc: 0.951
f1 : 0.937, best f1 : 0.929, save model : train
stop count :7
recall: 0.958
0 : 1013/1026=0.987
1 : 127/128=0.992
2 : 838/906=0.925
3 : 772/832=0.928
valid 15 time: 1.334 secs | loss : 0.432 | acc: 0.945
f1 : 0.880, best f1 : 0.929, save model : False
stop count :8
recall: 0.939
0 : 114/115=0.991
1 : 4/4=1.000
2 : 31/34=0.912
3 : 40/47=0.851
====================================================================================================
train 16 time: 66.978 secs | loss : 0.139 | acc: 0.962
f1 : 0.952, best f1 : 0.929, save model : train
stop count :8
recall: 0.969
0 : 1018/1026=0.992
1 : 128/128=1.000
2 : 844/906=0.932
3 : 793/832=0.953
valid 16 time: 1.326 secs | loss : 0.595 | acc: 0.900
f1 : 0.784, best f1 : 0.929, save model : False
stop count :9
recall: 0.898
0 : 113/115=0.983
1 : 4/4=1.000
2 : 33/34=0.971
3 : 30/47=0.638
====================================================================================================
train 17 time: 67.650 secs | loss : 0.093 | acc: 0.971
f1 : 0.972, best f1 : 0.929, save model : train
stop count :9
recall: 0.976
0 : 1023/1026=0.997
1 : 128/128=1.000
2 : 862/906=0.951
3 : 795/832=0.956
valid 17 time: 1.353 secs | loss : 1.248 | acc: 0.955
f1 : 0.843, best f1 : 0.929, save model : False
stop count :10
recall: 0.849
0 : 110/115=0.957
1 : 2/4=0.500
2 : 32/34=0.941
3 : 47/47=1.000
====================================================================================================
train 18 time: 67.243 secs | loss : 0.057 | acc: 0.981
f1 : 0.981, best f1 : 0.929, save model : train
stop count :10
recall: 0.984
0 : 1022/1026=0.996
1 : 128/128=1.000
2 : 878/906=0.969
3 : 809/832=0.972
valid 18 time: 1.419 secs | loss : 1.288 | acc: 0.980
f1 : 0.921, best f1 : 0.929, save model : False
stop count :11
recall: 0.921
0 : 114/115=0.991
1 : 3/4=0.750
2 : 32/34=0.941
3 : 47/47=1.000
====================================================================================================
train 19 time: 67.617 secs | loss : 0.139 | acc: 0.962
f1 : 0.952, best f1 : 0.929, save model : train
stop count :11
recall: 0.967
0 : 1019/1026=0.993
1 : 127/128=0.992
2 : 851/906=0.939
3 : 784/832=0.942
valid 19 time: 1.447 secs | loss : 0.972 | acc: 0.945
f1 : 0.881, best f1 : 0.929, save model : False
stop count :12
recall: 0.876
0 : 113/115=0.983
1 : 3/4=0.750
2 : 27/34=0.794
3 : 46/47=0.979
====================================================================================================
train 20 time: 67.294 secs | loss : 0.185 | acc: 0.957
f1 : 0.954, best f1 : 0.929, save model : train
stop count :12
recall: 0.959
0 : 1022/1026=0.996
1 : 125/128=0.977
2 : 841/906=0.928
3 : 779/832=0.936
valid 20 time: 1.407 secs | loss : 0.510 | acc: 0.955
f1 : 0.897, best f1 : 0.929, save model : False
stop count :13
recall: 0.961
0 : 111/115=0.965
1 : 4/4=1.000
2 : 32/34=0.941
3 : 44/47=0.936
====================================================================================================
train 21 time: 66.980 secs | loss : 0.357 | acc: 0.923
f1 : 0.881, best f1 : 0.929, save model : train
stop count :13
recall: 0.924
0 : 1007/1026=0.981
1 : 120/128=0.938
2 : 785/906=0.866
3 : 756/832=0.909
valid 21 time: 1.308 secs | loss : 1.204 | acc: 0.935
f1 : 0.831, best f1 : 0.929, save model : False
stop count :14
recall: 0.815
0 : 111/115=0.965
1 : 2/4=0.500
2 : 27/34=0.794
3 : 47/47=1.000
====================================================================================================
train 22 time: 67.747 secs | loss : 0.243 | acc: 0.940
f1 : 0.924, best f1 : 0.929, save model : train
stop count :14
recall: 0.947
0 : 1012/1026=0.986
1 : 126/128=0.984
2 : 816/906=0.901
3 : 764/832=0.918
valid 22 time: 1.359 secs | loss : 0.999 | acc: 0.935
f1 : 0.874, best f1 : 0.929, save model : False
stop count :15
recall: 0.861
0 : 114/115=0.991
1 : 3/4=0.750
2 : 26/34=0.765
3 : 44/47=0.936
====================================================================================================
train 23 time: 67.569 secs | loss : 0.205 | acc: 0.954
f1 : 0.943, best f1 : 0.929, save model : train
stop count :15
recall: 0.959
0 : 1014/1026=0.988
1 : 126/128=0.984
2 : 847/906=0.935
3 : 771/832=0.927
valid 23 time: 1.364 secs | loss : 1.192 | acc: 0.955
f1 : 0.876, best f1 : 0.929, save model : False
stop count :16
recall: 0.900
0 : 112/115=0.974
1 : 3/4=0.750
2 : 32/34=0.941
3 : 44/47=0.936
====================================================================================================
train 24 time: 67.781 secs | loss : 0.178 | acc: 0.959
f1 : 0.946, best f1 : 0.929, save model : train
stop count :16
recall: 0.962
0 : 1015/1026=0.989
1 : 125/128=0.977
2 : 848/906=0.936
3 : 786/832=0.945
valid 24 time: 1.370 secs | loss : 1.571 | acc: 0.860
f1 : 0.756, best f1 : 0.929, save model : False
stop count :17
recall: 0.824
0 : 104/115=0.904
1 : 3/4=0.750
2 : 32/34=0.941
3 : 33/47=0.702
====================================================================================================
train 25 time: 67.944 secs | loss : 0.116 | acc: 0.970
f1 : 0.965, best f1 : 0.929, save model : train
stop count :17
recall: 0.973
0 : 1020/1026=0.994
1 : 127/128=0.992
2 : 863/906=0.953
3 : 794/832=0.954
valid 25 time: 1.392 secs | loss : 0.778 | acc: 0.955
f1 : 0.868, best f1 : 0.929, save model : False
stop count :18
recall: 0.901
0 : 111/115=0.965
1 : 3/4=0.750
2 : 31/34=0.912
3 : 46/47=0.979
====================================================================================================
train 26 time: 67.668 secs | loss : 0.070 | acc: 0.976
f1 : 0.975, best f1 : 0.929, save model : train
stop count :18
recall: 0.981
0 : 1021/1026=0.995
1 : 128/128=1.000
2 : 872/906=0.962
3 : 803/832=0.965
valid 26 time: 1.288 secs | loss : 0.869 | acc: 0.965
f1 : 0.905, best f1 : 0.929, save model : False
stop count :19
recall: 0.905
0 : 114/115=0.991
1 : 3/4=0.750
2 : 32/34=0.941
3 : 44/47=0.936
====================================================================================================
train 27 time: 66.761 secs | loss : 0.054 | acc: 0.984
f1 : 0.984, best f1 : 0.929, save model : train
stop count :19
recall: 0.987
0 : 1024/1026=0.998
1 : 128/128=1.000
2 : 878/906=0.969
3 : 816/832=0.981
valid 27 time: 1.361 secs | loss : 1.086 | acc: 0.970
f1 : 0.908, best f1 : 0.929, save model : False
stop count :20
recall: 0.908
0 : 114/115=0.991
1 : 3/4=0.750
2 : 31/34=0.912
3 : 46/47=0.979
====================================================================================================
train 28 time: 65.772 secs | loss : 0.065 | acc: 0.980
f1 : 0.981, best f1 : 0.929, save model : train
stop count :20
recall: 0.983
0 : 1023/1026=0.997
1 : 128/128=1.000
2 : 877/906=0.968
3 : 805/832=0.968
valid 28 time: 1.281 secs | loss : 1.422 | acc: 0.955
f1 : 0.882, best f1 : 0.929, save model : False
stop count :21
recall: 0.903
0 : 111/115=0.965
1 : 3/4=0.750
2 : 32/34=0.941
3 : 45/47=0.957
====================================================================================================
train 29 time: 65.156 secs | loss : 0.029 | acc: 0.990
f1 : 0.990, best f1 : 0.929, save model : train
stop count :21
recall: 0.992
0 : 1024/1026=0.998
1 : 128/128=1.000
2 : 889/906=0.981
3 : 822/832=0.988
valid 29 time: 1.334 secs | loss : 1.471 | acc: 0.900
f1 : 0.775, best f1 : 0.929, save model : False
stop count :22
recall: 0.883
0 : 99/115=0.861
1 : 3/4=0.750
2 : 32/34=0.941
3 : 46/47=0.979
====================================================================================================
train 30 time: 64.707 secs | loss : 0.037 | acc: 0.992
f1 : 0.991, best f1 : 0.929, save model : train
stop count :22
recall: 0.994
0 : 1025/1026=0.999
1 : 128/128=1.000
2 : 896/906=0.989
3 : 821/832=0.987
valid 30 time: 1.235 secs | loss : 1.262 | acc: 0.955
f1 : 0.893, best f1 : 0.929, save model : False
stop count :23
recall: 0.889
0 : 115/115=1.000
1 : 3/4=0.750
2 : 31/34=0.912
3 : 42/47=0.894
====================================================================================================
train 31 time: 65.760 secs | loss : 0.025 | acc: 0.991
f1 : 0.992, best f1 : 0.929, save model : train
stop count :23
recall: 0.993
0 : 1023/1026=0.997
1 : 128/128=1.000
2 : 891/906=0.983
3 : 824/832=0.990
valid 31 time: 1.317 secs | loss : 0.832 | acc: 0.970
f1 : 0.912, best f1 : 0.929, save model : False
stop count :24
recall: 0.905
0 : 115/115=1.000
1 : 3/4=0.750
2 : 31/34=0.912
3 : 45/47=0.957
====================================================================================================
train 32 time: 65.564 secs | loss : 0.027 | acc: 0.992
f1 : 0.992, best f1 : 0.929, save model : train
stop count :24
recall: 0.993
0 : 1021/1026=0.995
1 : 128/128=1.000
2 : 896/906=0.989
3 : 823/832=0.989
valid 32 time: 1.233 secs | loss : 2.448 | acc: 0.950
f1 : 0.853, best f1 : 0.929, save model : False
stop count :25
recall: 0.842
0 : 110/115=0.957
1 : 2/4=0.500
2 : 31/34=0.912
3 : 47/47=1.000
====================================================================================================
train 33 time: 64.496 secs | loss : 0.024 | acc: 0.993
f1 : 0.995, best f1 : 0.929, save model : train
stop count :25
recall: 0.995
0 : 1026/1026=1.000
1 : 128/128=1.000
2 : 895/906=0.988
3 : 824/832=0.990
valid 33 time: 1.248 secs | loss : 1.488 | acc: 0.955
f1 : 0.873, best f1 : 0.929, save model : False
stop count :26
recall: 0.889
0 : 113/115=0.983
1 : 3/4=0.750
2 : 28/34=0.824
3 : 47/47=1.000
====================================================================================================
train 34 time: 64.481 secs | loss : 0.026 | acc: 0.991
f1 : 0.991, best f1 : 0.929, save model : train
stop count :26
recall: 0.992
0 : 1025/1026=0.999
1 : 128/128=1.000
2 : 893/906=0.986
3 : 819/832=0.984
valid 34 time: 1.254 secs | loss : 1.014 | acc: 0.965
f1 : 0.904, best f1 : 0.929, save model : False
stop count :27
recall: 0.905
0 : 114/115=0.991
1 : 3/4=0.750
2 : 32/34=0.941
3 : 44/47=0.936
====================================================================================================
train 35 time: 64.379 secs | loss : 0.046 | acc: 0.988
f1 : 0.987, best f1 : 0.929, save model : train
stop count :27
recall: 0.990
0 : 1025/1026=0.999
1 : 128/128=1.000
2 : 889/906=0.981
3 : 814/832=0.978
valid 35 time: 1.217 secs | loss : 0.862 | acc: 0.955
f1 : 0.894, best f1 : 0.929, save model : False
stop count :28
recall: 0.888
0 : 114/115=0.991
1 : 3/4=0.750
2 : 29/34=0.853
3 : 45/47=0.957
====================================================================================================
train 36 time: 64.818 secs | loss : 0.354 | acc: 0.930
f1 : 0.923, best f1 : 0.929, save model : train
stop count :28
recall: 0.938
0 : 1009/1026=0.983
1 : 125/128=0.977
2 : 794/906=0.876
3 : 762/832=0.916
valid 36 time: 1.276 secs | loss : 1.089 | acc: 0.900
f1 : 0.802, best f1 : 0.929, save model : False
stop count :29
recall: 0.769
0 : 115/115=1.000
1 : 2/4=0.500
2 : 29/34=0.853
3 : 34/47=0.723
====================================================================================================
train 37 time: 65.315 secs | loss : 0.428 | acc: 0.909
f1 : 0.885, best f1 : 0.929, save model : train
stop count :29
recall: 0.917
0 : 992/1026=0.967
1 : 122/128=0.953
2 : 773/906=0.853
3 : 743/832=0.893
valid 37 time: 1.350 secs | loss : 1.511 | acc: 0.945
f1 : 0.864, best f1 : 0.929, save model : False
stop count :30
recall: 0.877
0 : 114/115=0.991
1 : 3/4=0.750
2 : 29/34=0.853
3 : 43/47=0.915
No more improve on validation set, early stop
training using 43.28680765628815 mins.
test 
accuracy : 0.927, f1 : 0.883
recall : 0.890
{0: (281, 286, 0.9825174825174825), 1: (9, 10, 0.9), 2: (65, 84, 0.7738095238095238), 3: (105, 116, 0.9051724137931034)}
