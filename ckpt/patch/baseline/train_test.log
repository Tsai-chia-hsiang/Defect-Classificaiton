from connectedcomponents/patches/f_table.json reading all data
class-label map: {'Type1': 0, 'Type2': 1, 'Type3': 2}
settings :
lr: 0.0005, epochs : 30, batchsize : 512
{'Type1': 0, 'Type2': 1, 'Type3': 2}
resnet34
model will be saved at ckpt/patch/baseline/resnet34.pt
train data : tensor([  36.,  535., 1151.])
valid data : tensor([  5.,  58., 141.])
lossw for CrossEntropyLoss() : train : None, valid : None
Using 4 GPUs!
train 0 time: 5.740 secs | loss : 0.892 | acc: 0.571
f1 : 0.406, best f1 : 0.000, save model : train
stop count :0
recall: 0.434
0 : 6/36=0.167
1 : 285/535=0.533
2 : 692/1151=0.601
valid 0 time: 0.342 secs | loss : 1.139 | acc: 0.397
f1 : 0.256, best f1 : 0.256, save model : True
stop count :0
recall: 0.388
0 : 0/5=0.000
1 : 58/58=1.000
2 : 23/141=0.163
====================================================================================================
train 1 time: 3.616 secs | loss : 0.490 | acc: 0.821
f1 : 0.529, best f1 : 0.256, save model : train
stop count :0
recall: 0.523
0 : 0/36=0.000
1 : 339/535=0.634
2 : 1075/1151=0.934
valid 1 time: 0.306 secs | loss : 3.167 | acc: 0.299
f1 : 0.163, best f1 : 0.256, save model : False
stop count :1
recall: 0.340
0 : 0/5=0.000
1 : 58/58=1.000
2 : 3/141=0.021
====================================================================================================
train 2 time: 3.343 secs | loss : 0.325 | acc: 0.877
f1 : 0.693, best f1 : 0.256, save model : train
stop count :1
recall: 0.650
0 : 8/36=0.222
1 : 424/535=0.793
2 : 1078/1151=0.937
valid 2 time: 0.306 secs | loss : 1.667 | acc: 0.348
f1 : 0.212, best f1 : 0.256, save model : False
stop count :2
recall: 0.364
0 : 0/5=0.000
1 : 58/58=1.000
2 : 13/141=0.092
====================================================================================================
train 3 time: 3.461 secs | loss : 0.248 | acc: 0.908
f1 : 0.771, best f1 : 0.256, save model : train
stop count :2
recall: 0.727
0 : 14/36=0.389
1 : 445/535=0.832
2 : 1105/1151=0.960
valid 3 time: 0.303 secs | loss : 1.877 | acc: 0.382
f1 : 0.243, best f1 : 0.256, save model : False
stop count :3
recall: 0.381
0 : 0/5=0.000
1 : 58/58=1.000
2 : 20/141=0.142
====================================================================================================
train 4 time: 3.451 secs | loss : 0.195 | acc: 0.933
f1 : 0.861, best f1 : 0.256, save model : train
stop count :3
recall: 0.837
0 : 24/36=0.667
1 : 468/535=0.875
2 : 1115/1151=0.969
valid 4 time: 0.339 secs | loss : 1.820 | acc: 0.451
f1 : 0.407, best f1 : 0.407, save model : True
stop count :0
recall: 0.478
0 : 1/5=0.200
1 : 58/58=1.000
2 : 33/141=0.234
====================================================================================================
train 5 time: 3.399 secs | loss : 0.166 | acc: 0.941
f1 : 0.822, best f1 : 0.407, save model : train
stop count :0
recall: 0.765
0 : 15/36=0.417
1 : 483/535=0.903
2 : 1122/1151=0.975
valid 5 time: 0.319 secs | loss : 2.112 | acc: 0.382
f1 : 0.245, best f1 : 0.407, save model : False
stop count :1
recall: 0.381
0 : 0/5=0.000
1 : 58/58=1.000
2 : 20/141=0.142
====================================================================================================
train 6 time: 3.382 secs | loss : 0.124 | acc: 0.958
f1 : 0.908, best f1 : 0.407, save model : train
stop count :1
recall: 0.875
0 : 26/36=0.722
1 : 492/535=0.920
2 : 1131/1151=0.983
valid 6 time: 0.308 secs | loss : 2.758 | acc: 0.377
f1 : 0.319, best f1 : 0.407, save model : False
stop count :2
recall: 0.443
0 : 1/5=0.200
1 : 58/58=1.000
2 : 18/141=0.128
====================================================================================================
train 7 time: 3.342 secs | loss : 0.084 | acc: 0.972
f1 : 0.930, best f1 : 0.407, save model : train
stop count :2
recall: 0.906
0 : 28/36=0.778
1 : 509/535=0.951
2 : 1137/1151=0.988
valid 7 time: 0.308 secs | loss : 2.692 | acc: 0.407
f1 : 0.264, best f1 : 0.407, save model : False
stop count :3
recall: 0.392
0 : 0/5=0.000
1 : 58/58=1.000
2 : 25/141=0.177
====================================================================================================
train 8 time: 3.347 secs | loss : 0.047 | acc: 0.983
f1 : 0.947, best f1 : 0.407, save model : train
stop count :3
recall: 0.914
0 : 28/36=0.778
1 : 519/535=0.970
2 : 1145/1151=0.995
valid 8 time: 0.308 secs | loss : 3.544 | acc: 0.431
f1 : 0.376, best f1 : 0.407, save model : False
stop count :4
recall: 0.469
0 : 1/5=0.200
1 : 58/58=1.000
2 : 29/141=0.206
====================================================================================================
train 9 time: 3.446 secs | loss : 0.039 | acc: 0.987
f1 : 0.959, best f1 : 0.407, save model : train
stop count :4
recall: 0.955
0 : 32/36=0.889
1 : 528/535=0.987
2 : 1139/1151=0.990
valid 9 time: 0.308 secs | loss : 1.244 | acc: 0.716
f1 : 0.475, best f1 : 0.475, save model : True
stop count :0
recall: 0.521
0 : 0/5=0.000
1 : 52/58=0.897
2 : 94/141=0.667
====================================================================================================
train 10 time: 3.382 secs | loss : 0.028 | acc: 0.992
f1 : 0.960, best f1 : 0.475, save model : train
stop count :0
recall: 0.932
0 : 29/36=0.806
1 : 533/535=0.996
2 : 1146/1151=0.996
valid 10 time: 0.310 secs | loss : 0.922 | acc: 0.828
f1 : 0.542, best f1 : 0.542, save model : True
stop count :0
recall: 0.552
0 : 0/5=0.000
1 : 45/58=0.776
2 : 124/141=0.879
====================================================================================================
train 11 time: 3.366 secs | loss : 0.040 | acc: 0.988
f1 : 0.964, best f1 : 0.542, save model : train
stop count :0
recall: 0.956
0 : 32/36=0.889
1 : 528/535=0.987
2 : 1141/1151=0.991
valid 11 time: 0.308 secs | loss : 0.567 | acc: 0.868
f1 : 0.667, best f1 : 0.667, save model : True
stop count :0
recall: 0.642
0 : 1/5=0.200
1 : 47/58=0.810
2 : 129/141=0.915
====================================================================================================
train 12 time: 3.372 secs | loss : 0.033 | acc: 0.990
f1 : 0.983, best f1 : 0.667, save model : train
stop count :0
recall: 0.973
0 : 34/36=0.944
1 : 524/535=0.979
2 : 1146/1151=0.996
valid 12 time: 0.310 secs | loss : 0.611 | acc: 0.868
f1 : 0.569, best f1 : 0.667, save model : False
stop count :1
recall: 0.567
0 : 0/5=0.000
1 : 44/58=0.759
2 : 133/141=0.943
====================================================================================================
train 13 time: 3.351 secs | loss : 0.029 | acc: 0.991
f1 : 0.971, best f1 : 0.667, save model : train
stop count :1
recall: 0.968
0 : 33/36=0.917
1 : 532/535=0.994
2 : 1142/1151=0.992
valid 13 time: 0.309 secs | loss : 0.670 | acc: 0.863
f1 : 0.750, best f1 : 0.750, save model : True
stop count :0
recall: 0.690
0 : 2/5=0.400
1 : 43/58=0.741
2 : 131/141=0.929
====================================================================================================
train 14 time: 3.412 secs | loss : 0.047 | acc: 0.985
f1 : 0.975, best f1 : 0.750, save model : train
stop count :0
recall: 0.962
0 : 33/36=0.917
1 : 523/535=0.978
2 : 1141/1151=0.991
valid 14 time: 0.324 secs | loss : 0.932 | acc: 0.750
f1 : 0.609, best f1 : 0.750, save model : False
stop count :1
recall: 0.656
0 : 2/5=0.400
1 : 49/58=0.845
2 : 102/141=0.723
====================================================================================================
train 15 time: 3.359 secs | loss : 0.048 | acc: 0.980
f1 : 0.971, best f1 : 0.750, save model : train
stop count :1
recall: 0.975
0 : 35/36=0.972
1 : 517/535=0.966
2 : 1136/1151=0.987
valid 15 time: 0.311 secs | loss : 0.533 | acc: 0.863
f1 : 0.737, best f1 : 0.750, save model : False
stop count :2
recall: 0.775
0 : 3/5=0.600
1 : 49/58=0.845
2 : 124/141=0.879
====================================================================================================
train 16 time: 3.384 secs | loss : 0.039 | acc: 0.988
f1 : 0.990, best f1 : 0.750, save model : train
stop count :2
recall: 0.991
0 : 36/36=1.000
1 : 526/535=0.983
2 : 1139/1151=0.990
valid 16 time: 0.314 secs | loss : 0.728 | acc: 0.784
f1 : 0.696, best f1 : 0.750, save model : False
stop count :3
recall: 0.734
0 : 3/5=0.600
1 : 48/58=0.828
2 : 109/141=0.773
====================================================================================================
train 17 time: 3.377 secs | loss : 0.025 | acc: 0.995
f1 : 0.996, best f1 : 0.750, save model : train
stop count :3
recall: 0.996
0 : 36/36=1.000
1 : 530/535=0.991
2 : 1148/1151=0.997
valid 17 time: 0.309 secs | loss : 0.658 | acc: 0.873
f1 : 0.573, best f1 : 0.750, save model : False
stop count :4
recall: 0.570
0 : 0/5=0.000
1 : 44/58=0.759
2 : 134/141=0.950
====================================================================================================
train 18 time: 3.373 secs | loss : 0.020 | acc: 0.994
f1 : 0.995, best f1 : 0.750, save model : train
stop count :4
recall: 0.996
0 : 36/36=1.000
1 : 532/535=0.994
2 : 1144/1151=0.994
valid 18 time: 0.291 secs | loss : 0.749 | acc: 0.877
f1 : 0.684, best f1 : 0.750, save model : False
stop count :5
recall: 0.633
0 : 1/5=0.200
1 : 43/58=0.741
2 : 135/141=0.957
====================================================================================================
train 19 time: 3.354 secs | loss : 0.021 | acc: 0.994
f1 : 0.990, best f1 : 0.750, save model : train
stop count :5
recall: 0.987
0 : 35/36=0.972
1 : 531/535=0.993
2 : 1145/1151=0.995
valid 19 time: 0.312 secs | loss : 0.810 | acc: 0.819
f1 : 0.722, best f1 : 0.750, save model : False
stop count :6
recall: 0.679
0 : 2/5=0.400
1 : 46/58=0.793
2 : 119/141=0.844
====================================================================================================
train 20 time: 3.395 secs | loss : 0.016 | acc: 0.995
f1 : 0.987, best f1 : 0.750, save model : train
stop count :6
recall: 0.996
0 : 36/36=1.000
1 : 530/535=0.991
2 : 1147/1151=0.997
valid 20 time: 0.467 secs | loss : 0.675 | acc: 0.863
f1 : 0.752, best f1 : 0.752, save model : True
stop count :0
recall: 0.697
0 : 2/5=0.400
1 : 45/58=0.776
2 : 129/141=0.915
====================================================================================================
train 21 time: 3.428 secs | loss : 0.014 | acc: 0.997
f1 : 0.998, best f1 : 0.752, save model : train
stop count :0
recall: 0.997
0 : 36/36=1.000
1 : 530/535=0.991
2 : 1151/1151=1.000
valid 21 time: 0.308 secs | loss : 0.618 | acc: 0.882
f1 : 0.766, best f1 : 0.766, save model : True
stop count :0
recall: 0.706
0 : 2/5=0.400
1 : 45/58=0.776
2 : 133/141=0.943
====================================================================================================
train 22 time: 3.363 secs | loss : 0.010 | acc: 0.997
f1 : 0.997, best f1 : 0.766, save model : train
stop count :0
recall: 0.997
0 : 36/36=1.000
1 : 531/535=0.993
2 : 1149/1151=0.998
valid 22 time: 0.306 secs | loss : 0.617 | acc: 0.863
f1 : 0.673, best f1 : 0.766, save model : False
stop count :1
recall: 0.629
0 : 1/5=0.200
1 : 44/58=0.759
2 : 131/141=0.929
====================================================================================================
train 23 time: 3.314 secs | loss : 0.006 | acc: 0.999
f1 : 0.999, best f1 : 0.766, save model : train
stop count :1
recall: 0.999
0 : 36/36=1.000
1 : 533/535=0.996
2 : 1151/1151=1.000
valid 23 time: 0.306 secs | loss : 0.662 | acc: 0.838
f1 : 0.644, best f1 : 0.766, save model : False
stop count :2
recall: 0.624
0 : 1/5=0.200
1 : 46/58=0.793
2 : 124/141=0.879
====================================================================================================
train 24 time: 3.346 secs | loss : 0.002 | acc: 1.000
f1 : 1.000, best f1 : 0.766, save model : train
stop count :2
recall: 1.000
0 : 36/36=1.000
1 : 535/535=1.000
2 : 1151/1151=1.000
valid 24 time: 0.307 secs | loss : 0.728 | acc: 0.824
f1 : 0.705, best f1 : 0.766, save model : False
stop count :3
recall: 0.688
0 : 2/5=0.400
1 : 48/58=0.828
2 : 118/141=0.837
====================================================================================================
train 25 time: 3.332 secs | loss : 0.005 | acc: 0.999
f1 : 1.000, best f1 : 0.766, save model : train
stop count :3
recall: 1.000
0 : 36/36=1.000
1 : 535/535=1.000
2 : 1150/1151=0.999
valid 25 time: 0.309 secs | loss : 0.602 | acc: 0.873
f1 : 0.736, best f1 : 0.766, save model : False
stop count :4
recall: 0.702
0 : 2/5=0.400
1 : 45/58=0.776
2 : 131/141=0.929
====================================================================================================
train 26 time: 3.340 secs | loss : 0.005 | acc: 0.999
f1 : 0.999, best f1 : 0.766, save model : train
stop count :4
recall: 0.999
0 : 36/36=1.000
1 : 533/535=0.996
2 : 1151/1151=1.000
valid 26 time: 0.311 secs | loss : 0.633 | acc: 0.868
f1 : 0.758, best f1 : 0.766, save model : False
stop count :5
recall: 0.709
0 : 2/5=0.400
1 : 48/58=0.828
2 : 127/141=0.901
====================================================================================================
train 27 time: 3.396 secs | loss : 0.006 | acc: 0.997
f1 : 0.998, best f1 : 0.766, save model : train
stop count :5
recall: 0.998
0 : 36/36=1.000
1 : 532/535=0.994
2 : 1149/1151=0.998
valid 27 time: 0.307 secs | loss : 0.780 | acc: 0.868
f1 : 0.756, best f1 : 0.766, save model : False
stop count :6
recall: 0.699
0 : 2/5=0.400
1 : 45/58=0.776
2 : 130/141=0.922
====================================================================================================
train 28 time: 3.343 secs | loss : 0.004 | acc: 0.999
f1 : 1.000, best f1 : 0.766, save model : train
stop count :6
recall: 1.000
0 : 36/36=1.000
1 : 535/535=1.000
2 : 1150/1151=0.999
valid 28 time: 0.307 secs | loss : 0.835 | acc: 0.863
f1 : 0.727, best f1 : 0.766, save model : False
stop count :7
recall: 0.690
0 : 2/5=0.400
1 : 43/58=0.741
2 : 131/141=0.929
====================================================================================================
train 29 time: 3.340 secs | loss : 0.002 | acc: 1.000
f1 : 1.000, best f1 : 0.766, save model : train
stop count :7
recall: 1.000
0 : 36/36=1.000
1 : 535/535=1.000
2 : 1151/1151=1.000
valid 29 time: 0.308 secs | loss : 0.798 | acc: 0.863
f1 : 0.725, best f1 : 0.766, save model : False
stop count :8
recall: 0.683
0 : 2/5=0.400
1 : 41/58=0.707
2 : 133/141=0.943
====================================================================================================
training using 1.933392083644867 mins.
test 
accuracy : 0.882, f1 : 0.812
recall : 0.757
{0: (5, 9, 0.5555555555555556), 1: (112, 144, 0.7777777777777778), 2: (310, 331, 0.9365558912386707)}
