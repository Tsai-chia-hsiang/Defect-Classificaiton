from connectedcomponents/patches/f_table.json reading all data
class-label map: {'Type0': 0, 'Type1': 1, 'Type2': 2, 'Type3': 3}
settings :
lr: 0.0005, epochs : 30, batchsize : 256
{'Type0': 0, 'Type1': 1, 'Type2': 2, 'Type3': 3}
resnet34
model will be saved at ckpt/patch/baseline34/resnet34.pt
train data : tensor([  55.,   36.,  535., 1151.])
valid data : tensor([ 10.,   5.,  58., 141.])
lossw for CrossEntropyLoss() : train : None, valid : None
Using 4 GPUs!
train 0 time: 5.903 secs | loss : 0.781 | acc: 0.719
f1 : 0.401, best f1 : 0.000, save model : train
stop count :0
recall: 0.410
0 : 2/55=0.036
1 : 6/36=0.167
2 : 336/535=0.628
3 : 933/1151=0.811
valid 0 time: 0.389 secs | loss : 2.705 | acc: 0.262
f1 : 0.245, best f1 : 0.245, save model : True
stop count :0
recall: 0.420
0 : 10/10=1.000
1 : 1/5=0.200
2 : 16/58=0.276
3 : 29/141=0.206
====================================================================================================
train 1 time: 3.929 secs | loss : 0.448 | acc: 0.822
f1 : 0.576, best f1 : 0.245, save model : train
stop count :0
recall: 0.538
0 : 9/55=0.164
1 : 13/36=0.361
2 : 375/535=0.701
3 : 1064/1151=0.924
valid 1 time: 0.383 secs | loss : 0.861 | acc: 0.710
f1 : 0.515, best f1 : 0.515, save model : True
stop count :0
recall: 0.631
0 : 9/10=0.900
1 : 1/5=0.200
2 : 41/58=0.707
3 : 101/141=0.716
====================================================================================================
train 2 time: 4.126 secs | loss : 0.325 | acc: 0.885
f1 : 0.716, best f1 : 0.515, save model : train
stop count :0
recall: 0.647
0 : 21/55=0.382
1 : 16/36=0.444
2 : 429/535=0.802
3 : 1106/1151=0.961
valid 2 time: 0.386 secs | loss : 2.185 | acc: 0.435
f1 : 0.399, best f1 : 0.515, save model : False
stop count :1
recall: 0.544
0 : 10/10=1.000
1 : 1/5=0.200
2 : 39/58=0.672
3 : 43/141=0.305
====================================================================================================
train 3 time: 3.991 secs | loss : 0.245 | acc: 0.913
f1 : 0.805, best f1 : 0.515, save model : train
stop count :1
recall: 0.761
0 : 38/55=0.691
1 : 19/36=0.528
2 : 467/535=0.873
3 : 1098/1151=0.954
valid 3 time: 0.383 secs | loss : 1.276 | acc: 0.533
f1 : 0.386, best f1 : 0.515, save model : False
stop count :2
recall: 0.536
0 : 10/10=1.000
1 : 0/5=0.000
2 : 40/58=0.690
3 : 64/141=0.454
====================================================================================================
train 4 time: 3.925 secs | loss : 0.176 | acc: 0.938
f1 : 0.829, best f1 : 0.515, save model : train
stop count :2
recall: 0.804
0 : 35/55=0.636
1 : 25/36=0.694
2 : 490/535=0.916
3 : 1116/1151=0.970
valid 4 time: 0.350 secs | loss : 0.699 | acc: 0.743
f1 : 0.483, best f1 : 0.515, save model : False
stop count :3
recall: 0.543
0 : 6/10=0.600
1 : 0/5=0.000
2 : 48/58=0.828
3 : 105/141=0.745
====================================================================================================
train 5 time: 3.645 secs | loss : 0.138 | acc: 0.950
f1 : 0.847, best f1 : 0.515, save model : train
stop count :3
recall: 0.803
0 : 31/55=0.564
1 : 26/36=0.722
2 : 508/535=0.950
3 : 1124/1151=0.977
valid 5 time: 0.341 secs | loss : 0.605 | acc: 0.794
f1 : 0.504, best f1 : 0.515, save model : False
stop count :4
recall: 0.532
0 : 5/10=0.500
1 : 0/5=0.000
2 : 45/58=0.776
3 : 120/141=0.851
====================================================================================================
train 6 time: 3.629 secs | loss : 0.100 | acc: 0.965
f1 : 0.901, best f1 : 0.515, save model : train
stop count :4
recall: 0.880
0 : 49/55=0.891
1 : 25/36=0.694
2 : 507/535=0.948
3 : 1134/1151=0.985
valid 6 time: 0.341 secs | loss : 0.728 | acc: 0.766
f1 : 0.477, best f1 : 0.515, save model : False
stop count :5
recall: 0.511
0 : 4/10=0.400
1 : 0/5=0.000
2 : 50/58=0.862
3 : 110/141=0.780
====================================================================================================
train 7 time: 3.631 secs | loss : 0.071 | acc: 0.974
f1 : 0.938, best f1 : 0.515, save model : train
stop count :5
recall: 0.915
0 : 48/55=0.873
1 : 30/36=0.833
2 : 516/535=0.964
3 : 1137/1151=0.988
valid 7 time: 0.342 secs | loss : 0.595 | acc: 0.822
f1 : 0.517, best f1 : 0.517, save model : True
stop count :0
recall: 0.527
0 : 4/10=0.400
1 : 0/5=0.000
2 : 48/58=0.828
3 : 124/141=0.879
====================================================================================================
train 8 time: 3.680 secs | loss : 0.062 | acc: 0.974
f1 : 0.944, best f1 : 0.517, save model : train
stop count :0
recall: 0.956
0 : 54/55=0.982
1 : 32/36=0.889
2 : 523/535=0.978
3 : 1121/1151=0.974
valid 8 time: 0.343 secs | loss : 0.745 | acc: 0.785
f1 : 0.579, best f1 : 0.579, save model : True
stop count :0
recall: 0.578
0 : 3/10=0.300
1 : 2/5=0.400
2 : 45/58=0.776
3 : 118/141=0.837
====================================================================================================
train 9 time: 3.691 secs | loss : 0.064 | acc: 0.980
f1 : 0.960, best f1 : 0.579, save model : train
stop count :0
recall: 0.952
0 : 53/55=0.964
1 : 32/36=0.889
2 : 515/535=0.963
3 : 1141/1151=0.991
valid 9 time: 0.341 secs | loss : 0.817 | acc: 0.813
f1 : 0.607, best f1 : 0.607, save model : True
stop count :0
recall: 0.620
0 : 6/10=0.600
1 : 1/5=0.200
2 : 49/58=0.845
3 : 118/141=0.837
====================================================================================================
train 10 time: 3.601 secs | loss : 0.059 | acc: 0.978
f1 : 0.963, best f1 : 0.607, save model : train
stop count :0
recall: 0.947
0 : 53/55=0.964
1 : 31/36=0.861
2 : 526/535=0.983
3 : 1128/1151=0.980
valid 10 time: 0.345 secs | loss : 0.797 | acc: 0.836
f1 : 0.650, best f1 : 0.650, save model : True
stop count :0
recall: 0.638
0 : 3/10=0.300
1 : 3/5=0.600
2 : 42/58=0.724
3 : 131/141=0.929
====================================================================================================
train 11 time: 3.634 secs | loss : 0.044 | acc: 0.984
f1 : 0.971, best f1 : 0.650, save model : train
stop count :0
recall: 0.968
0 : 53/55=0.964
1 : 34/36=0.944
2 : 520/535=0.972
3 : 1142/1151=0.992
valid 11 time: 0.341 secs | loss : 0.867 | acc: 0.808
f1 : 0.656, best f1 : 0.656, save model : True
stop count :0
recall: 0.685
0 : 7/10=0.700
1 : 2/5=0.400
2 : 47/58=0.810
3 : 117/141=0.830
====================================================================================================
train 12 time: 3.839 secs | loss : 0.032 | acc: 0.990
f1 : 0.972, best f1 : 0.656, save model : train
stop count :0
recall: 0.967
0 : 50/55=0.909
1 : 35/36=0.972
2 : 531/535=0.993
3 : 1143/1151=0.993
valid 12 time: 0.349 secs | loss : 0.629 | acc: 0.818
f1 : 0.604, best f1 : 0.656, save model : False
stop count :1
recall: 0.570
0 : 2/10=0.200
1 : 2/5=0.400
2 : 46/58=0.793
3 : 125/141=0.887
====================================================================================================
train 13 time: 3.658 secs | loss : 0.022 | acc: 0.995
f1 : 0.991, best f1 : 0.656, save model : train
stop count :1
recall: 0.992
0 : 54/55=0.982
1 : 36/36=1.000
2 : 530/535=0.991
3 : 1148/1151=0.997
valid 13 time: 0.342 secs | loss : 0.868 | acc: 0.771
f1 : 0.637, best f1 : 0.656, save model : False
stop count :2
recall: 0.714
0 : 7/10=0.700
1 : 3/5=0.600
2 : 45/58=0.776
3 : 110/141=0.780
====================================================================================================
train 14 time: 3.643 secs | loss : 0.020 | acc: 0.993
f1 : 0.971, best f1 : 0.656, save model : train
stop count :2
recall: 0.960
0 : 48/55=0.873
1 : 35/36=0.972
2 : 534/535=0.998
3 : 1147/1151=0.997
valid 14 time: 0.336 secs | loss : 0.777 | acc: 0.860
f1 : 0.711, best f1 : 0.711, save model : True
stop count :0
recall: 0.701
0 : 5/10=0.500
1 : 3/5=0.600
2 : 45/58=0.776
3 : 131/141=0.929
====================================================================================================
train 15 time: 3.590 secs | loss : 0.029 | acc: 0.992
f1 : 0.989, best f1 : 0.711, save model : train
stop count :0
recall: 0.996
0 : 55/55=1.000
1 : 36/36=1.000
2 : 531/535=0.993
3 : 1141/1151=0.991
valid 15 time: 0.350 secs | loss : 1.059 | acc: 0.743
f1 : 0.537, best f1 : 0.711, save model : False
stop count :1
recall: 0.518
0 : 1/10=0.100
1 : 2/5=0.400
2 : 46/58=0.793
3 : 110/141=0.780
====================================================================================================
train 16 time: 3.633 secs | loss : 0.036 | acc: 0.988
f1 : 0.979, best f1 : 0.711, save model : train
stop count :1
recall: 0.975
0 : 51/55=0.927
1 : 36/36=1.000
2 : 523/535=0.978
3 : 1145/1151=0.995
valid 16 time: 0.351 secs | loss : 0.874 | acc: 0.850
f1 : 0.550, best f1 : 0.711, save model : False
stop count :2
recall: 0.501
0 : 1/10=0.100
1 : 1/5=0.200
2 : 42/58=0.724
3 : 138/141=0.979
====================================================================================================
train 17 time: 3.625 secs | loss : 0.043 | acc: 0.990
f1 : 0.979, best f1 : 0.711, save model : train
stop count :2
recall: 0.975
0 : 52/55=0.945
1 : 35/36=0.972
2 : 528/535=0.987
3 : 1144/1151=0.994
valid 17 time: 0.324 secs | loss : 0.786 | acc: 0.841
f1 : 0.648, best f1 : 0.711, save model : False
stop count :3
recall: 0.624
0 : 2/10=0.200
1 : 3/5=0.600
2 : 45/58=0.776
3 : 130/141=0.922
====================================================================================================
train 18 time: 3.707 secs | loss : 0.032 | acc: 0.990
f1 : 0.976, best f1 : 0.711, save model : train
stop count :3
recall: 0.977
0 : 54/55=0.982
1 : 34/36=0.944
2 : 529/535=0.989
3 : 1143/1151=0.993
valid 18 time: 0.344 secs | loss : 0.957 | acc: 0.757
f1 : 0.574, best f1 : 0.711, save model : False
stop count :4
recall: 0.555
0 : 4/10=0.400
1 : 1/5=0.200
2 : 50/58=0.862
3 : 107/141=0.759
====================================================================================================
train 19 time: 3.653 secs | loss : 0.028 | acc: 0.990
f1 : 0.986, best f1 : 0.711, save model : train
stop count :4
recall: 0.982
0 : 52/55=0.945
1 : 36/36=1.000
2 : 532/535=0.994
3 : 1139/1151=0.990
valid 19 time: 0.342 secs | loss : 0.899 | acc: 0.734
f1 : 0.579, best f1 : 0.711, save model : False
stop count :5
recall: 0.587
0 : 4/10=0.400
1 : 2/5=0.400
2 : 47/58=0.810
3 : 104/141=0.738
====================================================================================================
train 20 time: 3.633 secs | loss : 0.029 | acc: 0.992
f1 : 0.984, best f1 : 0.711, save model : train
stop count :5
recall: 0.989
0 : 55/55=1.000
1 : 35/36=0.972
2 : 529/535=0.989
3 : 1143/1151=0.993
valid 20 time: 0.342 secs | loss : 0.672 | acc: 0.836
f1 : 0.516, best f1 : 0.711, save model : False
stop count :6
recall: 0.504
0 : 3/10=0.300
1 : 0/5=0.000
2 : 46/58=0.793
3 : 130/141=0.922
====================================================================================================
train 21 time: 3.672 secs | loss : 0.021 | acc: 0.994
f1 : 0.986, best f1 : 0.711, save model : train
stop count :6
recall: 0.981
0 : 53/55=0.964
1 : 35/36=0.972
2 : 531/535=0.993
3 : 1148/1151=0.997
valid 21 time: 0.343 secs | loss : 0.793 | acc: 0.846
f1 : 0.657, best f1 : 0.711, save model : False
stop count :7
recall: 0.645
0 : 5/10=0.500
1 : 2/5=0.400
2 : 44/58=0.759
3 : 130/141=0.922
====================================================================================================
train 22 time: 3.592 secs | loss : 0.020 | acc: 0.993
f1 : 0.984, best f1 : 0.711, save model : train
stop count :7
recall: 0.989
0 : 55/55=1.000
1 : 35/36=0.972
2 : 528/535=0.987
3 : 1146/1151=0.996
valid 22 time: 0.493 secs | loss : 0.860 | acc: 0.850
f1 : 0.672, best f1 : 0.711, save model : False
stop count :8
recall: 0.619
0 : 4/10=0.400
1 : 2/5=0.400
2 : 42/58=0.724
3 : 134/141=0.950
====================================================================================================
train 23 time: 3.649 secs | loss : 0.012 | acc: 0.997
f1 : 0.993, best f1 : 0.711, save model : train
stop count :8
recall: 0.994
0 : 54/55=0.982
1 : 36/36=1.000
2 : 533/535=0.996
3 : 1148/1151=0.997
valid 23 time: 0.344 secs | loss : 0.767 | acc: 0.846
f1 : 0.662, best f1 : 0.711, save model : False
stop count :9
recall: 0.655
0 : 3/10=0.300
1 : 3/5=0.600
2 : 47/58=0.810
3 : 128/141=0.908
====================================================================================================
train 24 time: 3.667 secs | loss : 0.015 | acc: 0.996
f1 : 0.996, best f1 : 0.711, save model : train
stop count :9
recall: 0.993
0 : 54/55=0.982
1 : 36/36=1.000
2 : 531/535=0.993
3 : 1149/1151=0.998
valid 24 time: 0.341 secs | loss : 0.862 | acc: 0.794
f1 : 0.521, best f1 : 0.711, save model : False
stop count :10
recall: 0.500
0 : 2/10=0.200
1 : 1/5=0.200
2 : 41/58=0.707
3 : 126/141=0.894
====================================================================================================
train 25 time: 3.673 secs | loss : 0.012 | acc: 0.996
f1 : 0.989, best f1 : 0.711, save model : train
stop count :10
recall: 0.985
0 : 55/55=1.000
1 : 34/36=0.944
2 : 533/535=0.996
3 : 1148/1151=0.997
valid 25 time: 0.341 secs | loss : 1.087 | acc: 0.841
f1 : 0.537, best f1 : 0.711, save model : False
stop count :11
recall: 0.495
0 : 1/10=0.100
1 : 1/5=0.200
2 : 41/58=0.707
3 : 137/141=0.972
====================================================================================================
train 26 time: 3.620 secs | loss : 0.016 | acc: 0.994
f1 : 0.994, best f1 : 0.711, save model : train
stop count :11
recall: 0.992
0 : 54/55=0.982
1 : 36/36=1.000
2 : 528/535=0.987
3 : 1148/1151=0.997
valid 26 time: 0.343 secs | loss : 0.993 | acc: 0.846
f1 : 0.578, best f1 : 0.711, save model : False
stop count :12
recall: 0.542
0 : 1/10=0.100
1 : 2/5=0.400
2 : 40/58=0.690
3 : 138/141=0.979
====================================================================================================
train 27 time: 3.652 secs | loss : 0.017 | acc: 0.995
f1 : 0.997, best f1 : 0.711, save model : train
stop count :12
recall: 0.997
0 : 55/55=1.000
1 : 36/36=1.000
2 : 532/535=0.994
3 : 1145/1151=0.995
valid 27 time: 0.346 secs | loss : 0.999 | acc: 0.836
f1 : 0.566, best f1 : 0.711, save model : False
stop count :13
recall: 0.519
0 : 2/10=0.200
1 : 1/5=0.200
2 : 42/58=0.724
3 : 134/141=0.950
====================================================================================================
train 28 time: 3.642 secs | loss : 0.009 | acc: 0.998
f1 : 0.999, best f1 : 0.711, save model : train
stop count :13
recall: 0.998
0 : 55/55=1.000
1 : 36/36=1.000
2 : 532/535=0.994
3 : 1150/1151=0.999
valid 28 time: 0.342 secs | loss : 0.908 | acc: 0.846
f1 : 0.544, best f1 : 0.711, save model : False
stop count :14
recall: 0.514
0 : 1/10=0.100
1 : 1/5=0.200
2 : 48/58=0.828
3 : 131/141=0.929
====================================================================================================
train 29 time: 3.672 secs | loss : 0.014 | acc: 0.995
f1 : 0.993, best f1 : 0.711, save model : train
stop count :14
recall: 0.993
0 : 54/55=0.982
1 : 36/36=1.000
2 : 532/535=0.994
3 : 1147/1151=0.997
valid 29 time: 0.344 secs | loss : 0.979 | acc: 0.818
f1 : 0.519, best f1 : 0.711, save model : False
stop count :15
recall: 0.486
0 : 1/10=0.100
1 : 1/5=0.200
2 : 41/58=0.707
3 : 132/141=0.936
====================================================================================================
training using 2.1064269304275514 mins.
test 
accuracy : 0.828, f1 : 0.654
recall : 0.655
{0: (9, 22, 0.4090909090909091), 1: (5, 9, 0.5555555555555556), 2: (110, 144, 0.7638888888888888), 3: (295, 331, 0.8912386706948641)}
